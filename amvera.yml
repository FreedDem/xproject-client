meta:
  environment: node
  toolchain:
    name: node
    version: "20"

build:
  skip: false
  additionalCommands: |
    set -e
    echo "=== üöÄ START AMVERA BUILD ==="
    echo "Node version:" && node -v
    echo "NPM version:" && npm -v

    # –û—á–∏—Å—Ç–∏–º –≤—Å—ë —Å—Ç–∞—Ä–æ–µ
    rm -rf dist node_modules
    npm ci

    # –ü—Ä–æ–≤–µ—Ä–∏–º —Ñ–∞–π–ª—ã, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–¥ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π
    echo "==== HEAD src/api.js ====" && head -n 20 src/api.js || true
    echo "==== HEAD src/App.jsx ====" && head -n 20 src/App.jsx || true

    # –Ø–≤–Ω–æ –ø–æ–∫–∞–∂–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
    echo "==== Using API base: https://xproject-server-freede.amvera.io ===="

    # –°–±–æ—Ä–∫–∞
    npm run build:prod

    echo "=== ‚úÖ BUILD FINISHED ==="
    ls -la dist || true

run:
  command: npm start
